<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Salvo 'LtWorf' Tomaselli <tiposchi@tiscali.it>" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>typedload - typedload</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "typedload";
        var mkdocs_page_input_path = "typedload_docgen.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="index.html" class="icon icon-home"> typedload
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="index.html">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Using typedload</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="supported_types.html">Supported types</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="errors.html">Errors</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="deferred_evaluation.html">Deferred evaluation of types</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Docstrings</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="typedload_docgen.html">typedload</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="typedload.dataloader_docgen.html">typedload.dataloader</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="typedload.datadumper_docgen.html">typedload.datadumper</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="typedload.typechecks_docgen.html">typedload.typechecks</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="typedload.exceptions_docgen.html">typedload.exceptions</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Comparisons</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="comparisons.html">Why typedload</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="performance.html">Performance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Contributors</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="CODE_OF_CONDUCT.html">Code of conduct</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Links</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://github.com/ltworf/typedload/">Git</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/ltworf/typedload/releases">Downloads</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/ltworf/typedload/issues">Bug reports</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://liberapay.com/ltworf">Donate</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://packages.debian.org/search?keywords=python3-typedload">Debian package</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://pypi.org/project/typedload/">Pypi package</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://pypistats.org/packages/typedload">Pypi stats</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Other</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="version_numbers.html">Versioning scheme</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">typedload</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html" class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>Docstrings &raquo;</li>
      <li class="breadcrumb-item active">typedload</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="typedload">typedload</h1>
<p>This library loads Python data structures into
typed data structures, enforcing a schema.</p>
<p>The main purpose is to load things that come from
json, bson or similar into NamedTuple or Dataclass.</p>
<p>For example this Json:
   {
       'users': [
           {
               'username': 'salvo',
               'shell': 'bash',
               'sessions': ['pts/4', 'tty7', 'pts/6']
           },
           {
               'username': 'lop'
           }
       ],
   }</p>
<p>Can be treated more easily if loaded into this:</p>
<p>class User(NamedTuple):
   username: str
   shell: str = 'bash'
   sessions: List[str] = []</p>
<p>class Logins(NamedTuple):
   users: List[User]</p>
<p>And can then be loaded with</p>
<p>typedload.load(data, Logins)</p>
<h1 id="simple-api">Simple API</h1>
<p>typedload.load() and typedload.dump() are functions to quickly load and dump
data using the default objects.</p>
<p>They create a new loader/dumper object with default parameters, and
discard it after.</p>
<h1 id="classes">Classes</h1>
<p>The loader and dumper classes expose a number of attributes that can be
customised to tweak their behaviour.</p>
<h1 id="supported-datatypes">Supported datatypes</h1>
<p>There is support for:
    * Basic python types (int, str, bool, float, NoneType)
    * NamedTuple
    * Enum
    * Optional[SomeType]
    * List[SomeType]
    * Dict[TypeA, TypeB]
    * Tuple[TypeA, TypeB, TypeC]
    * Tuple[SomeType, ...]
    * Set[SomeType]
    * Union[TypeA, TypeB]
    * ForwardRef
    * Literal
    * Dataclass
    * attrs
    * TypedDict
    * datetime
    * Path
    * IPv4Address, IPv6Address</p>
<h1 id="handlers">Handlers</h1>
<p>To work with other datatypes, handlers can be used.</p>
<p>The handlers' list items are tuples for two functions. The signatures are
different for loader or dumper.</p>
<p>The first function returns a boolean, and if the value is true, the object
will call the second function and return its result.</p>
<p>Basically a loader and a dumper class have no functionality (but come with
a default list of handlers).</p>
<p>So, to add support for a new type, it is sufficient to write a function that
outputs the desired value, and a function that decides when to call that.</p>
<p>The index() function returns the position of handlers in the list, so that
it is possible to remove them or add new handlers before or after a given
handler.</p>
<p>The pointer to the loader or dumper object is passed, so that the attributes
in use for that particular object are available.</p>
<p>For example, if we want to add a special loader that when loading the int 42
into a string returns 'quarantadue', we can do this:</p>
<p>from typedload.dataloader import Loader
l = Loader()
l.handlers.insert(
    l.index(str), # This will place this entry before the string handler
    (
        lambda x: x == str,
        lambda loader, value, type_: str(value) if value != 42 else 'quarantadue'
    )
)</p>
<p>Then this will happen:</p>
<p>In [15]: l.load(12, str)
Out[15]: '12'</p>
<p>In [16]: l.load(42, str)
Out[16]: 'quarantadue'</p>
<p>This can of course be used also for use cases that make sense.</p>
<p>The handlers must generate exceptions from the typedload.exceptions
module.</p>
<p>Due to internal cache, it is not supported to modify the list of the
handlers after the first call to dump/load.</p>
<h1 id="name-mangling">Name mangling</h1>
<p>Name mangling is supported in datatypes with metadata (dataclass, attrs) by
having a 'name' key in the metadata.</p>
<p>@attr.s
class Example:
    attribute = attr.ib(type=int, metadata={'name': 'att.rib.ute:name'}</p>
<p>@dataclass
class Example():
  attribute: str = field(metadata={'name': 'att.rib.ute:name'})</p>
<p>The dictionary key for 'attribute' will be 'att.rib.ute:name'.</p>
<p>This is very useful for keys that use invalid or reserved characters that
can't be used in variable names.
Another common application is to convert camelCase into not_camel_case.</p>
<p>It is implemented this way to avoid doing automatic name translations,
that might introduce surprises.</p>
<p>To use a metadata key different than 'name', set the mangle_key parameter
to the loader/dumper.</p>
<h1 id="functions">Functions</h1>
<h2 id="load">load</h2>
<pre><code>Quick function call to load data into a type.

It is useful to avoid creating the Loader object,
in case only the default parameters are used.

For repeated calls this function will be slower than re-using
a loader object.
</code></pre>
<h2 id="dump">dump</h2>
<pre><code>Quick function to dump a data structure into
something that is compatible with json or
other programs and languages.

It is useful to avoid creating the Dumper object,
in case only the default parameters are used.
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="deferred_evaluation.html" class="btn btn-neutral float-left" title="Deferred evaluation of types"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="typedload.dataloader_docgen.html" class="btn btn-neutral float-right" title="typedload.dataloader">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright (C) 2018-2023 Salvo "LtWorf" Tomaselli</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="deferred_evaluation.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="typedload.dataloader_docgen.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
<!-- Trackers stripped from mkdocs theme by me -_-' -->
